var app = getApp(), $ = require("../../utils/util.js"), userapi = require("../../api/userAPI.js"); Page({ data: { pageindex: 1, tapindex: 0, ispage: !0, flag: !0, SuitProduct: [], Id: 0, viewtype: 0 }, onLoad: function (e) { app.globalData.getTop(); this.setData({ Id: e.id }), this.getCouponlist() }, getCouponlist: function () { var e = { openId: app.globalData.UserInfo.WeiXinOpenId, PageIndex: this.data.pageindex, CouponId: this.data.Id }; console.log(e); var t = this; $.xsr($.makeUrl(userapi.GetCouponLimitProduct, e), function (e) { console.log("product---list---ï¼š", e), e.dataList != null && e.errcode != 1 ? e.dataList.length < 10 ? t.setData({ SuitProduct: t.data.SuitProduct.concat(e.dataList), flag: !1, ispage: !1 }) : t.setData({ SuitProduct: t.data.SuitProduct.concat(e.dataList) }) : t.setData({ flag: !1, ispage: !1 }) }) }, scrollbottom: function () { if (this.data.flag) { var e = this; clearTimeout(t); var t = setTimeout(function () { e.setData({ pageindex: parseInt(e.data.pageindex) + 1 }), e.getCouponlist() }, 500) } }, viewType: function () { var e = this.data.viewtype; e == 0 ? e = 1 : e = 0, this.setData({ viewtype: e }) } });